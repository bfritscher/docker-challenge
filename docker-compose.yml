services:
  web:
    build: .
    ports:
      - "5000:5000"
    volumes:
      - ./app.py:/app/app.py
      - ./templates:/app/templates
      - ./data:/data
      - certs:/certs
    environment:
      FLASK_APP: "app.py"
      FLASK_DEBUG: 1
      DOCKER_TLS_CERTDIR: /certs

  dind:
    image: docker:dind
    privileged: true
    volumes:
      - ./challenge:/challenge/:ro  # Read-only volume for Dockerfiles
      - certs:/certs
volumes:
  certs: